datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["fullTextSearch", "fullTextIndex"]
}

model Offer {
  id             String          @id
  available      Boolean
  title          String
  mataTitle      String?
  slug           String?
  description    String
  sku            String?
  price          Int
  quantity       Int?
  categories     OfferCategory[]
  images         OfferImg[]
  vendor         OfferVendor[]
  params         OfferParam[]
  relevantWith   Offer[]         @relation("RelevantOffers", references: [id])
  relevantOffers Offer[]         @relation("RelevantOffers", references: [id])
  createdAt      DateTime        @default(now())
  updatedAt      DateTime        @updatedAt

  @@fulltext([title])
}

model Category {
  id          String          @id
  parentId    String?
  title       String?
  metaTitle   String?
  slug        String?
  description String?
  offers      OfferCategory[]
}

model OfferCategory {
  id         Int      @id @default(autoincrement())
  offer      Offer    @relation(fields: [offerId], references: [id])
  offerId    String
  category   Category @relation(fields: [categoryId], references: [id])
  categoryId String
}

model Vendor {
  id          Int           @id @default(autoincrement())
  title       String        @unique
  metaTitle   String?
  slug        String?
  description String?
  offers      OfferVendor[]
}

model OfferVendor {
  id       Int    @id @default(autoincrement())
  offer    Offer  @relation(fields: [offerId], references: [id])
  offerId  String
  vendor   Vendor @relation(fields: [vendorId], references: [id])
  vendorId Int
}

model OfferImg {
  id      Int    @id @default(autoincrement())
  offer   Offer  @relation(fields: [offerId], references: [id])
  offerId String
  imgUrl  String
}

model Param {
  id     Int          @id @default(autoincrement())
  name   String       @unique
  offers OfferParam[]
}

model OfferParam {
  id      Int    @id @default(autoincrement())
  offer   Offer  @relation(fields: [offerId], references: [id])
  offerId String
  param   Param  @relation(fields: [paramId], references: [id])
  paramId Int
  value   String
}
