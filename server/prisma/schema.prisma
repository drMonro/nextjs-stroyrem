datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["fullTextSearch", "fullTextIndex"]
}

model Offer {
  id             String          @id
  available      Boolean
  title          String
  mataTitle      String?
  slug           String?
  description    String          @db.LongText
  sku            String?
  price          Int
  quantity       Int?
  categories     OfferCategory[]
  images         OfferImg[]
  vendor         OfferVendor[]
  params         OfferParam[]
  relevantWith   Offer[]         @relation("RelevantOffers", references: [id])
  relevantOffers Offer[]         @relation("RelevantOffers", references: [id])
  createdAt      DateTime        @default(now())
  updatedAt      DateTime        @updatedAt

  @@fulltext([title])
}

model Category {
  id          String          @id
  title       String?
  metaTitle   String?
  slug        String?
  description String?
  parentId    String
  parent      Category        @relation("CategoryHeritance", fields: [parentId], references: [id])
  kids        Category[]      @relation("CategoryHeritance")
  offers      OfferCategory[]
}

model OfferCategory {
  id         Int      @id @default(autoincrement())
  offer      Offer    @relation(fields: [offerId], references: [id])
  offerId    String
  category   Category @relation(fields: [categoryId], references: [id])
  categoryId String
}

model Vendor {
  id          String        @id @default(cuid())
  title       String        @unique
  metaTitle   String?
  slug        String?
  description String?
  offers      OfferVendor[]
}

model OfferVendor {
  id       String @id @default(cuid())
  offer    Offer  @relation(fields: [offerId], references: [id])
  offerId  String
  vendor   Vendor @relation(fields: [vendorId], references: [id])
  vendorId String
}

model Img {
  id     String     @default(cuid())
  imgUrl String     @unique
  offers OfferImg[]
  @@id([id, imgUrl])
}

model OfferImg {
  id      String @id @default(cuid())
  offer   Offer  @relation(fields: [offerId], references: [id])
  offerId String
  param   Img    @relation(fields: [imgId], references: [id])
  imgId   String
}

model Param {
  id     String       @id @default(cuid())
  name   String       @unique
  offers OfferParam[]
}

model OfferParam {
  id      String @id @default(cuid())
  offer   Offer  @relation(fields: [offerId], references: [id])
  offerId String
  param   Param  @relation(fields: [paramId], references: [id])
  paramId String
  value   String
}
